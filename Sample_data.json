{
  "test_cases": [
    {
      "name": "Duplicate Payment - Email",
      "request": {
        "customer_id": "99876",
        "channel": "email",
        "message": "My credit card payment was deducted twice yesterday.",
        "email": "customer1@example.com"
      },
      "expected": {
        "classification": "duplicate_payment",
        "confidence": 0.98
      },
      "what_happens": [
        "✅ Incident created with UUID",
        "✅ Google Gemini classifies (98% accuracy)",
        "✅ Ticket generated (TKT-xxx)",
        "✅ REAL email sent to customer1@example.com",
        "✅ Data stored in incidents table",
        "✅ Notification logged in notifications table",
        "✅ 24-hour reminder scheduled"
      ]
    },
    {
      "name": "Fraud Report - SMS",
      "request": {
        "customer_id": "55555",
        "channel": "sms",
        "message": "I see unauthorized $500 transaction I didn't make. This is fraud!",
        "email": "customer2@example.com"
      },
      "expected": {
        "classification": "fraud_report",
        "confidence": 0.96
      },
      "what_happens": [
        "✅ Incident created",
        "✅ Gemini detects high-risk fraud",
        "✅ Ticket marked as priority",
        "✅ Email sent to customer2@example.com",
        "✅ SMS notification (mocked)",
        "✅ Database updated"
      ]
    },
    {
      "name": "Failed Payment - WhatsApp",
      "request": {
        "customer_id": "12345",
        "channel": "whatsapp",
        "message": "Payment failed but $50 was deducted from my account",
        "email": "customer3@example.com"
      },
      "expected": {
        "classification": "failed_payment",
        "confidence": 0.94
      },
      "what_happens": [
        "✅ Incident created",
        "✅ Gemini identifies failed_payment",
        "✅ Email sent: customer3@example.com",
        "✅ Ticket for refund processing",
        "✅ 24h reminder for follow-up"
      ]
    },
    {
      "name": "Refund Request",
      "request": {
        "customer_id": "77777",
        "channel": "email",
        "message": "I want a refund for the premium subscription. I don't need it anymore.",
        "email": "customer4@example.com"
      },
      "expected": {
        "classification": "refund_request",
        "confidence": 0.95
      }
    },
    {
      "name": "Account Locked",
      "request": {
        "customer_id": "88888",
        "channel": "email",
        "message": "My account is locked and I can't log in",
        "email": "customer5@example.com"
      },
      "expected": {
        "classification": "account_locked",
        "confidence": 0.92
      }
    },
    {
      "name": "Statement Error",
      "request": {
        "customer_id": "33333",
        "channel": "email",
        "message": "My statement shows $100 balance but I have $500",
        "email": "customer6@example.com"
      },
      "expected": {
        "classification": "statement_error",
        "confidence": 0.89
      }
    },
    {
      "name": "Vague Message",
      "request": {
        "customer_id": "44444",
        "channel": "email",
        "message": "help",
        "email": "customer7@example.com"
      },
      "expected": {
        "classification": "other",
        "confidence": "0.4-0.6"
      }
    }
  ],
  "quick_test_commands": {
    "duplicate_payment": "curl -X POST http://localhost:8000/api/incidents -H 'Content-Type: application/json' -d '{\"customer_id\": \"99876\", \"channel\": \"email\", \"message\": \"I was charged twice\", \"email\": \"test@example.com\"}'",
    "fraud": "curl -X POST http://localhost:8000/api/incidents -H 'Content-Type: application/json' -d '{\"customer_id\": \"55555\", \"channel\": \"email\", \"message\": \"Unauthorized $500 transaction\", \"email\": \"test@example.com\"}'",
    "refund": "curl -X POST http://localhost:8000/api/incidents -H 'Content-Type: application/json' -d '{\"customer_id\": \"77777\", \"channel\": \"email\", \"message\": \"I want a refund\", \"email\": \"test@example.com\"}'",
    "get_incident": "curl http://localhost:8000/api/incidents/{incident_id}",
    "customer_incidents": "curl http://localhost:8000/api/incidents/customer/99876",
    "resolve": "curl -X PUT http://localhost:8000/api/incidents/{incident_id}/resolve",
    "stats": "curl http://localhost:8000/api/stats",
    "health": "curl http://localhost:8000/health"
  },
  "swagger_ui_steps": {
    "instructions": [
      "1. Open http://localhost:8000/docs",
      "2. Click 'POST /api/incidents'",
      "3. Click 'Try it out'",
      "4. Enter any test case JSON (with email field)",
      "5. Click 'Execute'",
      "6. ✅ See incident_id, ticket_id, classification"
    ],
    "expected_response": {
      "incident_id": "e5f7a2b1-4c8d-4b2a-9e1c-3d5f7a2b4c8d",
      "ticket_id": "TKT-98042a72",
      "status": "open",
      "classification": "duplicate_payment",
      "confidence": 0.98,
      "message": "Incident received and ticket created. Acknowledgments sent via email and SMS."
    }
  },
  "classification_guide": {
    "duplicate_payment": {
      "description": "Customer charged 2+ times for same transaction",
      "examples": ["charged twice", "double billed", "deducted twice"],
      "expected_confidence": "0.95-0.99"
    },
    "failed_payment": {
      "description": "Payment failed but money was deducted",
      "examples": ["payment failed but charged", "transaction declined but money gone"],
      "expected_confidence": "0.90-0.98"
    },
    "fraud_report": {
      "description": "Unauthorized or suspicious transaction",
      "examples": ["unauthorized charge", "didn't make this purchase", "suspicious activity"],
      "expected_confidence": "0.92-0.99"
    },
    "refund_request": {
      "description": "Customer explicitly requests refund",
      "examples": ["want refund", "return my money", "reverse charge"],
      "expected_confidence": "0.90-0.98"
    },
    "account_locked": {
      "description": "Customer can't access their account",
      "examples": ["can't log in", "account locked", "password not working"],
      "expected_confidence": "0.88-0.96"
    },
    "statement_error": {
      "description": "Discrepancy in balance or statement",
      "examples": ["balance wrong", "statement mismatch", "missing transaction"],
      "expected_confidence": "0.85-0.95"
    },
    "other": {
      "description": "Doesn't fit any above category",
      "examples": ["help", "hi", "general inquiry"],
      "expected_confidence": "0.3-0.7"
    }
  },
  "database_queries": {
    "view_all_incidents": "sqlite3 incidents.db \"SELECT id, customer_id, classification, confidence, status FROM incidents;\"",
    "view_all_notifications": "sqlite3 incidents.db \"SELECT incident_id, channel, sent_at FROM notifications;\"",
    "view_customer_history": "sqlite3 incidents.db \"SELECT * FROM incidents WHERE customer_id = '99876';\"",
    "count_by_classification": "sqlite3 incidents.db \"SELECT classification, COUNT(*) FROM incidents GROUP BY classification;\"",
    "view_open_incidents": "sqlite3 incidents.db \"SELECT * FROM incidents WHERE status = 'open';\"",
    "view_resolved_incidents": "sqlite3 incidents.db \"SELECT * FROM incidents WHERE status = 'resolved';\""
  },
  "interview_demo_flow": {
    "step_1": "Run: python app.py",
    "step_2": "Open: http://localhost:8000/docs",
    "step_3": "Test Duplicate Payment case with email",
    "step_4": "Show incident_id, classification (0.98), email sent",
    "step_5": "Check database: sqlite3 incidents.db",
    "step_6": "Show GET /api/stats - count by classification",
    "step_7": "Explain: 'This shows AI classification + real email + database audit trail'"
  },
  "expected_outcomes": {
    "successful_incident": {
      "status_code": 201,
      "has_incident_id": true,
      "has_ticket_id": true,
      "classification_accuracy": "95%+",
      "email_sent": true,
      "database_stored": true
    },
    "real_email_received": {
      "from": "your-email@gmail.com",
      "to": "customer@example.com",
      "subject": "Incident Update - Ticket TKT-xxx",
      "contains": ["Thank you", "Incident ID", "24 hours"]
    },
    "24_hour_reminder": {
      "wait_seconds": 40,
      "check": "SELECT reminder_sent FROM incidents WHERE id = '{incident_id}'",
      "after_test": "reminder_sent = 1"
    }
  }
}